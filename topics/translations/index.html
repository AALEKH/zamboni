<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Translating Fields on Models &mdash; zamboni v0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="zamboni v0.1 documentation" href="../../" />
    <link rel="next" title="A page about Jingo." href="../../ref/jingo/" />
    <link rel="prev" title="Sphinx (but not the Search Engine)" href="../sphinx/" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex/" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="../../ref/jingo/" title="A page about Jingo."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../sphinx/" title="Sphinx (but not the Search Engine)"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">zamboni v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="translating-fields-on-models">
<span id="translations"></span><h1>Translating Fields on Models<a class="headerlink" href="#translating-fields-on-models" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">translations</span></tt> app defines a <a title="translations.models.Translation" class="reference internal" href="#translations.models.Translation"><tt class="xref docutils literal"><span class="pre">Translation</span></tt></a>
model, but for the most part, you shouldn&#8217;t have to use that directly.  When you
want to create a foreign key to the <tt class="docutils literal"><span class="pre">translations</span></tt> table, use
<a title="translations.fields.TranslatedField" class="reference internal" href="#translations.fields.TranslatedField"><tt class="xref docutils literal"><span class="pre">translations.fields.TranslatedField</span></tt></a>.  This subclasses Django&#8217;s
<a title="(in Django v1.1)" class="reference external" href="http://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey"><tt class="xref docutils literal"><span class="pre">django.db.models.ForeignKey</span></tt></a> to make it work with our special handling
of translation rows.</p>
<p>A minimal Addon model looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">amo</span>
<span class="kn">from</span> <span class="nn">translations.fields</span> <span class="kn">import</span> <span class="n">TranslatedField</span>

<span class="k">class</span> <span class="nc">Addon</span><span class="p">(</span><span class="n">amo</span><span class="o">.</span><span class="n">ModelBase</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">TranslatedField</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">TranslatedField</span><span class="p">()</span>
</pre></div>
</div>
<p><tt class="xref docutils literal"><span class="pre">amo.ModelBase</span></tt> inherits from
<a title="translations.fields.TranslatedFieldMixin" class="reference internal" href="#translations.fields.TranslatedFieldMixin"><tt class="xref docutils literal"><span class="pre">translations.fields.TranslatedFieldMixin</span></tt></a>, which fetches all of a
model&#8217;s translations during initialization.  It first tries to fetch strings for
the current locale, and then looks for any missing strings in the default
locale.  If you want to change this behavior, it should be enough to override
<a title="translations.fields.TranslatedFieldMixin.fetch_translations" class="reference internal" href="#translations.fields.TranslatedFieldMixin.fetch_translations"><tt class="xref docutils literal"><span class="pre">fetch_translations()</span></tt></a>.</p>
<div class="section" id="creating-new-translations">
<h2>Creating New Translations<a class="headerlink" href="#creating-new-translations" title="Permalink to this headline">¶</a></h2>
<p>If you need to create new
<a title="translations.models.Translation" class="reference internal" href="#translations.models.Translation"><tt class="xref docutils literal"><span class="pre">Translations</span></tt></a> without the automagic
helpers behind <a title="translations.fields.TranslatedField" class="reference internal" href="#translations.fields.TranslatedField"><tt class="xref docutils literal"><span class="pre">TranslatedField</span></tt></a>, use
<a title="translations.models.Translation.new" class="reference internal" href="#translations.models.Translation.new"><tt class="xref docutils literal"><span class="pre">Translation.new</span></tt></a>.</p>
<dl class="classmethod">
<dt id="translations.models.Translation.new">
<em class="property">classmethod </em><tt class="descclassname">Translation.</tt><tt class="descname">new</tt><big>(</big><em>string</em>, <em>locale</em>, <em>id=None</em><big>)</big><a class="headerlink" href="#translations.models.Translation.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Jumps through all the right hoops to create a new translation.</p>
<p>If <tt class="docutils literal"><span class="pre">id</span></tt> is not given a new id will be created using
<tt class="docutils literal"><span class="pre">translations_seq</span></tt>.  Otherwise, the id will be used to add strings to
an existing translation.</p>
</dd></dl>

</div>
<div class="section" id="module-translations.fields">
<h2><tt class="docutils literal"><span class="pre">translations.fields</span></tt><a class="headerlink" href="#module-translations.fields" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="translations.fields.TranslatedField">
<em class="property">class </em><tt class="descclassname">translations.fields.</tt><tt class="descname">TranslatedField</tt><a class="headerlink" href="#translations.fields.TranslatedField" title="Permalink to this definition">¶</a></dt>
<dd>A foreign key to the translations table.</dd></dl>

<dl class="class">
<dt id="translations.fields.TranslatedFieldMixin">
<em class="property">class </em><tt class="descclassname">translations.fields.</tt><tt class="descname">TranslatedFieldMixin</tt><big>(</big><em>*args</em>, <em>**kw</em><big>)</big><a class="headerlink" href="#translations.fields.TranslatedFieldMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin that fetches all <tt class="docutils literal"><span class="pre">TranslatedFields</span></tt> after instantiation.</p>
<dl class="method">
<dt id="translations.fields.TranslatedFieldMixin.fetch_translations">
<tt class="descname">fetch_translations</tt><big>(</big><em>ids</em>, <em>lang</em><big>)</big><a class="headerlink" href="#translations.fields.TranslatedFieldMixin.fetch_translations" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the query for finding Translation objects.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ids</span></tt> is a list of the foreign keys to the object&#8217;s translations</li>
<li><tt class="docutils literal"><span class="pre">lang</span></tt> is the language of the current request</li>
</ul>
<p>Override this to search for translations in an unusual way.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-translations.models">
<h2><tt class="docutils literal"><span class="pre">translations.models</span></tt><a class="headerlink" href="#module-translations.models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="translations.models.Translation">
<em class="property">class </em><tt class="descclassname">translations.models.</tt><tt class="descname">Translation</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#translations.models.Translation" title="Permalink to this definition">¶</a></dt>
<dd><p>Translation model.</p>
<p>Use <a title="translations.fields.TranslatedField" class="reference internal" href="#translations.fields.TranslatedField"><tt class="xref docutils literal"><span class="pre">translations.fields.TranslatedField</span></tt></a> instead of a plain foreign
key to this model.</p>
</dd></dl>

<dl class="class">
<dt id="translations.models.TranslationSequence">
<em class="property">class </em><tt class="descclassname">translations.models.</tt><tt class="descname">TranslationSequence</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#translations.models.TranslationSequence" title="Permalink to this definition">¶</a></dt>
<dd>The translations_seq table, so syncdb will create it during testing.</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Translating Fields on Models</a><ul>
<li><a class="reference external" href="#creating-new-translations">Creating New Translations</a></li>
<li><a class="reference external" href="#module-translations.fields"><tt class="docutils literal"><span class="pre">translations.fields</span></tt></a></li>
<li><a class="reference external" href="#module-translations.models"><tt class="docutils literal"><span class="pre">translations.models</span></tt></a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../sphinx/"
                                  title="previous chapter">Sphinx (but not the Search Engine)</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../../ref/jingo/"
                                  title="next chapter">A page about Jingo.</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/topics/translations.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search/" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../modindex/" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../ref/jingo/" title="A page about Jingo."
             >next</a> |</li>
        <li class="right" >
          <a href="../sphinx/" title="Sphinx (but not the Search Engine)"
             >previous</a> |</li>
        <li><a href="../../">zamboni v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009, The Zamboni Collective.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>